[
  {
    "id" : "5a7c74b4-3f80-4126-8368-b03f6729b17b",
    "prId" : 1978,
    "comments" : [
      {
        "id" : "bd8a9d3f-61fc-4a01-aa16-c6329d7b46d0",
        "parentId" : null,
        "author" : {
          "login" : "dos65",
          "name" : "Vadim Chelyshov",
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/5816952?u=801a9faa2796a46c371c28cc181e0fa6abbb7132&v=4"
        },
        "body" : "I think it should check the existence for `.scala` files too, not only `.sbt`.\r\n\r\nHowever, it's probably it's hard to find a project that has sbt-scala sources somewhere deeper than in `.project/` directory",
        "createdAt" : "2020-08-07T10:52:07Z",
        "updatedAt" : "2020-08-07T10:52:07Z",
        "lastEditedBy" : {
          "login" : "dos65",
          "name" : "Vadim Chelyshov",
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/5816952?u=801a9faa2796a46c371c28cc181e0fa6abbb7132&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "ca51f74e-275e-4742-ba1c-ee102606acec",
        "parentId" : "bd8a9d3f-61fc-4a01-aa16-c6329d7b46d0",
        "author" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "body" : "We are not really registering those files within the correct build target, I will fix up together later.",
        "createdAt" : "2020-08-07T11:04:58Z",
        "updatedAt" : "2020-08-07T11:04:58Z",
        "lastEditedBy" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "6bc3195e72fd6abcbe2ea77ab110577e0477ca73",
    "line" : 39,
    "diffHunk" : "@@ -1,1 +95,99 @@        val files = meta.list.toList\n        val hasSbtSrc = files.exists(f => f.isSbt && f.filename != \"metals.sbt\")\n        if (hasSbtSrc) {\n          val forSbtSupport = meta.resolve(\"project/project\")\n          sbtMetaDirs(meta.resolve(\"project\"), acc + forSbtSupport)"
  },
  {
    "id" : "7967c721-dee8-4388-bef8-2febce6c82a9",
    "prId" : 1865,
    "comments" : [
      {
        "id" : "3a6924da-544d-4af0-9d0c-7c55170f1a17",
        "parentId" : null,
        "author" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "body" : "We should also check if these directories exist.",
        "createdAt" : "2020-07-06T17:50:17Z",
        "updatedAt" : "2020-07-31T11:55:17Z",
        "lastEditedBy" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "19e7a381-46af-4f6c-9650-5f7fb6c9e5a9",
        "parentId" : "3a6924da-544d-4af0-9d0c-7c55170f1a17",
        "author" : {
          "login" : "dos65",
          "name" : "Vadim Chelyshov",
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/5816952?u=801a9faa2796a46c371c28cc181e0fa6abbb7132&v=4"
        },
        "body" : "If they aren't then they will be created in function below.\r\nhttps://github.com/scalameta/metals/blob/71ebf3d7b546d98483b4426d176d01a84bd70d69/metals/src/main/scala/scala/meta/internal/builds/SbtBuildTool.scala#L117-L125",
        "createdAt" : "2020-07-21T11:12:26Z",
        "updatedAt" : "2020-07-31T11:55:17Z",
        "lastEditedBy" : {
          "login" : "dos65",
          "name" : "Vadim Chelyshov",
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/5816952?u=801a9faa2796a46c371c28cc181e0fa6abbb7132&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "4757a0c2-4493-48b8-8093-4f8405e32711",
        "parentId" : "3a6924da-544d-4af0-9d0c-7c55170f1a17",
        "author" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "body" : "Cool. One additional thing that I did notice is that when we create `metals.sbt` file then the next `bloopInstall` will create a next level and then the next during consequtive install, which we should not do. We should only create those files if `metals.sbt` is not the only thing in the project directory.",
        "createdAt" : "2020-07-21T13:47:55Z",
        "updatedAt" : "2020-07-31T11:55:17Z",
        "lastEditedBy" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "1ecc085ce9f65d042e2055d19fd627c5d49e7918",
    "line" : 38,
    "diffHunk" : "@@ -1,1 +113,117 @@    }\n\n    val mainMeta = workspace.resolve(\"project\")\n    val dirs = sbtMetaDirs(mainMeta, true, List(mainMeta))\n"
  },
  {
    "id" : "d492eded-2980-4713-abfe-e71c9e4dbb84",
    "prId" : 852,
    "comments" : [
      {
        "id" : "4178d2f2-2a1f-40a1-98d3-c6917d377dbd",
        "parentId" : null,
        "author" : {
          "login" : "jvican",
          "name" : "Jorge",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/2462974?u=247f9a0cfd142440687595dce462fabed087e912&v=4"
        },
        "body" : "Should we not also create this file in `project/project/metals.sbt` if any Scala files are defined under `project`?",
        "createdAt" : "2019-08-05T16:10:20Z",
        "updatedAt" : "2019-10-02T17:05:22Z",
        "lastEditedBy" : {
          "login" : "jvican",
          "name" : "Jorge",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/2462974?u=247f9a0cfd142440687595dce462fabed087e912&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "3008209e-2ef3-4941-a448-cc6ad8b7f960",
        "parentId" : "4178d2f2-2a1f-40a1-98d3-c6917d377dbd",
        "author" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "body" : "The sbt targets are not yet supported, so this will only be needed once we actually add sbt support",
        "createdAt" : "2019-08-09T09:03:12Z",
        "updatedAt" : "2019-10-02T17:05:22Z",
        "lastEditedBy" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "e9d56bec-af12-467c-97af-b261195732d3",
        "parentId" : "4178d2f2-2a1f-40a1-98d3-c6917d377dbd",
        "author" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "body" : "Additionally we can add to metals.sbt `bloopExportJarClassifiers := Some(Set(\\\"source\\\"))` if we add plugin to project/project. Should be easy to do when working on sbt support",
        "createdAt" : "2019-08-12T11:49:43Z",
        "updatedAt" : "2019-10-02T17:05:22Z",
        "lastEditedBy" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "21f992f2b66ce835b0205c99a71b743ae3ba960f",
    "line" : 75,
    "diffHunk" : "@@ -1,1 +99,103 @@    val projectDir = workspace.resolve(\"project\")\n    projectDir.toFile.mkdir()\n    val metalsPluginfile = projectDir.resolve(\"metals.sbt\")\n    val pluginFileShouldChange = !metalsPluginfile.isFile ||\n      !metalsPluginfile.readAllBytes.sameElements(bytes)"
  },
  {
    "id" : "689437f3-ae5a-4909-a104-807dedad7f66",
    "prId" : 852,
    "comments" : [
      {
        "id" : "1e0600ad-fef6-4eb5-b03d-d15d65adefe3",
        "parentId" : null,
        "author" : {
          "login" : "jvican",
          "name" : "Jorge",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/2462974?u=247f9a0cfd142440687595dce462fabed087e912&v=4"
        },
        "body" : "Migration-wise, we should probably delete the global metals.sbt if it exists so that whenever people already using Metals upgrade to the next version they don't use the previous mechanism to import the build.",
        "createdAt" : "2019-08-05T16:17:29Z",
        "updatedAt" : "2019-10-02T17:05:22Z",
        "lastEditedBy" : {
          "login" : "jvican",
          "name" : "Jorge",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/2462974?u=247f9a0cfd142440687595dce462fabed087e912&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "d46754e8-a207-46f7-860a-e3829447ec64",
        "parentId" : "1e0600ad-fef6-4eb5-b03d-d15d65adefe3",
        "author" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "body" : "Great idea! Thanks!",
        "createdAt" : "2019-08-09T09:03:37Z",
        "updatedAt" : "2019-10-02T17:05:22Z",
        "lastEditedBy" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "25978ceb-d22f-4e5c-a3db-a739cfa0f40b",
        "parentId" : "1e0600ad-fef6-4eb5-b03d-d15d65adefe3",
        "author" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "body" : "Added!",
        "createdAt" : "2019-08-12T11:34:47Z",
        "updatedAt" : "2019-10-02T17:05:22Z",
        "lastEditedBy" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "21f992f2b66ce835b0205c99a71b743ae3ba960f",
    "line" : 61,
    "diffHunk" : "@@ -1,1 +67,71 @@  // global sbt plugins and which adds the plugin to each projects\n  // and creates additional overhead.\n  private def removeLegacyGlobalPlugin(): Unit = {\n    def pluginsDirectory(version: String): AbsolutePath = {\n      AbsolutePath(System.getProperty(\"user.home\"))"
  },
  {
    "id" : "32e09d4d-4997-44e6-88c0-f18878bb9543",
    "prId" : 852,
    "comments" : [
      {
        "id" : "d5268671-b259-458d-9f53-5b7d4e2f06b1",
        "parentId" : null,
        "author" : {
          "login" : "olafurpg",
          "name" : "Ólafur Páll Geirsson",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/1408093?v=4"
        },
        "body" : "I'm very excited to get rid of this here :D ",
        "createdAt" : "2019-08-25T17:51:52Z",
        "updatedAt" : "2019-10-02T17:05:22Z",
        "lastEditedBy" : {
          "login" : "olafurpg",
          "name" : "Ólafur Páll Geirsson",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/1408093?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "21f992f2b66ce835b0205c99a71b743ae3ba960f",
    "line" : 102,
    "diffHunk" : "@@ -1,1 +117,121 @@    val project = workspace.toNIO.resolve(\"project\")\n    val isToplevel = Set(\n      workspace.toNIO,\n      project,\n      project.resolve(\"project\")"
  },
  {
    "id" : "829c2853-1f5a-4299-a87f-21519a363454",
    "prId" : 852,
    "comments" : [
      {
        "id" : "d5bb6bf7-5833-42ed-aca9-4b3eba56cd8e",
        "parentId" : null,
        "author" : {
          "login" : "olafurpg",
          "name" : "Ólafur Páll Geirsson",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/1408093?v=4"
        },
        "body" : "\r\n```suggestion\r\n    val isPreReleaseVersion = bloopSbtVersion.contains(\"+\") || bloopSbtVersion.contains(\"-\")\r\n```\r\nStrictly speaking, a snapshot version should end with `-SNAPSHOT`. Including `-` also guards us if bloop changes it's usage of `+` versions. Some filesystems require weird encodings for filenames with `+`.",
        "createdAt" : "2019-08-25T17:56:28Z",
        "updatedAt" : "2019-10-02T17:05:22Z",
        "lastEditedBy" : {
          "login" : "olafurpg",
          "name" : "Ólafur Páll Geirsson",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/1408093?v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "f077d402-bf2f-4e29-9f9f-9eee8179d6bc",
        "parentId" : "d5bb6bf7-5833-42ed-aca9-4b3eba56cd8e",
        "author" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "body" : "I don't think bloop ever releases with `version-SNAPSHOT`, but I can add it here, just don't think it will change much.",
        "createdAt" : "2019-08-28T12:58:23Z",
        "updatedAt" : "2019-10-02T17:05:22Z",
        "lastEditedBy" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "1904a208-d516-49a6-addc-c771b64249b8",
        "parentId" : "d5bb6bf7-5833-42ed-aca9-4b3eba56cd8e",
        "author" : {
          "login" : "olafurpg",
          "name" : "Ólafur Páll Geirsson",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/1408093?v=4"
        },
        "body" : "Fair point.",
        "createdAt" : "2019-08-28T22:25:36Z",
        "updatedAt" : "2019-10-02T17:05:22Z",
        "lastEditedBy" : {
          "login" : "olafurpg",
          "name" : "Ólafur Páll Geirsson",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/1408093?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "21f992f2b66ce835b0205c99a71b743ae3ba960f",
    "line" : 113,
    "diffHunk" : "@@ -1,1 +133,137 @@   */\n  private def sbtPlugin(bloopSbtVersion: String): String = {\n    val isSnapshotVersion = bloopSbtVersion.contains(\"+\")\n    val resolvers = if (isSnapshotVersion) {\n      \"\"\"resolvers += Resolver.bintrayRepo(\"scalacenter\", \"releases\")\"\"\""
  },
  {
    "id" : "7624012a-5a32-4e22-8088-faffaa52135c",
    "prId" : 852,
    "comments" : [
      {
        "id" : "2c806b8b-eeaf-4fd1-8db4-25bcd7083bb1",
        "parentId" : null,
        "author" : {
          "login" : "olafurpg",
          "name" : "Ólafur Páll Geirsson",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/1408093?v=4"
        },
        "body" : "What do you think about adding the following entries as well?\r\n```\r\n.metals/\r\n.bloop/\r\n```\r\nThese entries should ideally be in the workspace .gitignore instead of the global .gitignore because VS Code only uses the workspace gitignore in \"Open file\".",
        "createdAt" : "2019-08-25T21:02:59Z",
        "updatedAt" : "2019-10-02T17:05:22Z",
        "lastEditedBy" : {
          "login" : "olafurpg",
          "name" : "Ólafur Páll Geirsson",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/1408093?v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "ec5b6f95-9e0c-4d99-9355-eddc1fa0d237",
        "parentId" : "2c806b8b-eeaf-4fd1-8db4-25bcd7083bb1",
        "author" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "body" : "I was thinking about it, but decided not to do in this PR, but I can for sure do it here.",
        "createdAt" : "2019-08-28T13:00:22Z",
        "updatedAt" : "2019-10-02T17:05:22Z",
        "lastEditedBy" : {
          "login" : "tgodzik",
          "name" : "Tomasz Godzik",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/3807253?u=094831e6a696f583ddfd86d3e5923fd8545c543a&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "0a46a3cf-68cc-458b-afac-616efe233543",
        "parentId" : "2c806b8b-eeaf-4fd1-8db4-25bcd7083bb1",
        "author" : {
          "login" : "olafurpg",
          "name" : "Ólafur Páll Geirsson",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/1408093?v=4"
        },
        "body" : "It can be done as a separate PR.",
        "createdAt" : "2019-08-28T22:25:51Z",
        "updatedAt" : "2019-10-02T17:05:22Z",
        "lastEditedBy" : {
          "login" : "olafurpg",
          "name" : "Ólafur Páll Geirsson",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/1408093?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "21f992f2b66ce835b0205c99a71b743ae3ba960f",
    "line" : 50,
    "diffHunk" : "@@ -1,1 +84,88 @@  private def gitignoreMetals(workspace: AbsolutePath) = {\n    val gitignore = workspace.resolve(\".gitignore\")\n    val gitIgnoreContents = \"project/metals.sbt\"\n    if (gitignore.exists && !gitignore.readText.contains(gitIgnoreContents)) {\n      gitignore.appendText(s\"\\n$gitIgnoreContents\\n\")"
  }
]